import{_ as E,b as S,n as j,w as B,c as r,d as t,t as i,a as q,F as I,f as N,p as J,e as w,q as M,v as P,x as y,h as p,i as V,j as F,o as c}from"./index-Bbd5V1TY.js";import{l as k}from"./lessonsApi-jzLH2AXw.js";const R={key:0,class:"lesson-container"},Y={key:0,class:"loading"},z={key:1,class:"error"},A={key:2,class:"box-info"},D={class:"title-box"},G={class:"lesson-content"},U={class:"theory-section"},K=["innerHTML"],O={class:"box-btn"},Q=["disabled"],W={__name:"Lesson",setup(X){const o=F(),$=V(),n=p(null),g=p(!1),d=p(null),u=p(!0),h=p(!1),b=y(()=>{const e=o.path;return e.includes("/javascript/")?"JavaScript":e.includes("/css/")?"Css":e.includes("/html/")?"Html":"JavaScript"}),_=y(()=>{const e=o.path;return e.includes("/javascript/")?"/javascript":e.includes("/css/")?"/css":e.includes("/html/")?"/html":"/javascript"}),x=y(()=>o.params.slug);async function f(){g.value=!0,d.value=null,n.value=null;try{const e=o.path.split("/").pop()||o.params.slug;if(!e)throw new Error(`Урок не найден: ${e}`);const s=await L(b.value,e);u.value=s;const l=await k.getLesson(b.value,e);n.value=l,await P(),v()}catch(e){console.error("❌ Ошибка:",e),d.value=e.message,u.value=null}finally{g.value=!1}}async function L(e,s){try{const l=await k.allLessons(e),a=l.findIndex(m=>m.slug===s);return a!==-1&&a<l.length-1?l[a+1]:null}catch(l){return console.error("Ошибка в nextLessons:",l),null}}function H(){var s;if(!((s=u.value)!=null&&s.slug))return;const e=`${_.value}/${u.value.slug}`;$.push(e)}function T(e){return e?e.replace(/^# (.*$)/gm,'<h1 class="theory-h1">$1</h1>').replace(/^## (.*$)/gm,'<h2 class="theory-h2">$1</h2>').replace(/^### (.*$)/gm,'<h3 class="theory-h3">$1</h3>').replace(/^#### (.*$)/gm,'<h4 class="theory-h4">$1</h4>').replace(/```(\w*)\n([\s\S]*?)```/g,'<div class="code-block"><span class="lang-label">$1</span><pre><code>$2</code></pre></div>').replace(/`([^`]+)`/g,'<code class="inline-code">$1</code>').replace(/^\* (.*$)/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/s,'<ul class="theory-list">$1</ul>').replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^-{3,}$/gm,'<hr class="theory-hr">').replace(/^> (.*$)/gm,'<blockquote class="theory-quote">$1</blockquote>').replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" class="theory-link" target="_blank">$1</a>').replace(/\n\n/g,'</p><p class="theory-paragraph">').replace(/^\s*([^\n]+)(?=\n|$)/gm,'<p class="theory-paragraph">$1</p>').replace(/<\/p><p class="theory-paragraph"><\/p>/g,"").replace(/<p class="theory-paragraph"><\/p>/g,""):""}function v(){const e=window.scrollY,s=document.documentElement.scrollHeight,l=window.innerHeight,a=s-l;if(a<=0){h.value=!1;return}const m=a/2;h.value=e<m}function C(){const e=h.value?document.documentElement.scrollHeight:0;window.scrollTo({top:e,behavior:"smooth"})}return S(()=>{f(),window.addEventListener("scroll",v),v()}),j(()=>{window.removeEventListener("scroll",v)}),B(()=>o.path,()=>{f()}),(e,s)=>x.value?(c(),r("div",R,[g.value?(c(),r("div",Y,[...s[3]||(s[3]=[t("p",null,"Загрузка урока...",-1)])])):d.value?(c(),r("div",z,[s[4]||(s[4]=t("h2",null,"Ошибка",-1)),t("p",null,i(d.value),1),t("button",{onClick:f},"Попробовать снова")])):n.value?(c(),r("div",A,[t("div",D,[t("h2",null,i(n.value.title),1),s[5]||(s[5]=t("li",{class:"far fa-clock"},null,-1)),q(" "+i(n.value.time)+" минут ",1),t("p",null,i(n.value.description),1)]),t("div",G,[s[6]||(s[6]=t("h3",null,"Что вы узнаете:",-1)),t("ul",null,[(c(!0),r(I,null,N(n.value.points,l=>(c(),r("li",{key:l},i(l),1))),128))])]),t("div",U,[s[7]||(s[7]=t("h3",{class:"theory-title"},"Теория",-1)),t("div",{class:"theory-content",innerHTML:T(n.value.theory)},null,8,K)]),t("div",O,[t("button",{class:"btn-back",onClick:s[0]||(s[0]=l=>J($).go(-1))}," Назад "),t("button",{class:"btn-back",id:"next-theme",onClick:s[1]||(s[1]=l=>H()),disabled:!u.value}," Следующая Тема ",8,Q)])])):w("",!0),t("button",{class:"btn-heigth",onClick:s[2]||(s[2]=l=>C())},[t("i",{class:M(h.value?"fas fa-arrow-down":"fas fa-arrow-up")},null,2)])])):w("",!0)}},se=E(W,[["__scopeId","data-v-2adeb735"]]);export{se as default};
