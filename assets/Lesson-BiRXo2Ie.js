import{_ as E,h as S,q as j,g as B,c as a,a as t,t as r,b as q,F as I,i as N,x as J,n as w,y as M,p as P,d as $,r as p,j as V,k as F,o as c}from"./index-CMxqogrW.js";import{l as k}from"./lessonsApi-jzLH2AXw.js";const R={key:0,class:"lesson-container"},Y={key:0,class:"loading"},z={key:1,class:"error"},A={key:2,class:"box-info"},D={class:"title-box"},G={class:"lesson-content"},U={class:"theory-section"},K=["innerHTML"],O={class:"box-btn"},Q=["disabled"],W={__name:"Lesson",setup(X){const u=F(),b=V(),n=p(null),g=p(!1),d=p(null),i=p(!0),h=p(!1),f=$(()=>{const e=u.path;return e.includes("/javascript/")?"JavaScript":e.includes("/css/")?"Css":e.includes("/html/")?"Html":"JavaScript"}),_=$(()=>{const e=u.path;return e.includes("/javascript/")?"/javascript":e.includes("/css/")?"/css":e.includes("/html/")?"/html":"/javascript"}),x=$(()=>u.params.slug);async function m(){g.value=!0,d.value=null,n.value=null;try{const e=u.path.split("/").pop();if(!e)throw new Error(`Урок не найден: ${e}`);const s=await L(f.value,e);i.value=s;const l=await k.getLesson(f.value,e);n.value=l,await P(),v()}catch(e){console.error("❌ Ошибка:",e),d.value=e.message,i.value=null}finally{g.value=!1}}async function L(e,s){try{const l=await k.getTopics(e),o=l.findIndex(y=>y.slug===s);return o!==-1&&o<l.length-1?l[o+1]:null}catch(l){return console.error("Ошибка в nextLessons:",l),null}}function T(){var s;if(!((s=i.value)!=null&&s.slug))return;const e=`${_.value}/${i.value.slug}`;b.push(e)}function H(e){return e?e.replace(/^# (.*$)/gm,'<h1 class="theory-h1">$1</h1>').replace(/^## (.*$)/gm,'<h2 class="theory-h2">$1</h2>').replace(/^### (.*$)/gm,'<h3 class="theory-h3">$1</h3>').replace(/^#### (.*$)/gm,'<h4 class="theory-h4">$1</h4>').replace(/```(\w*)\n([\s\S]*?)```/g,'<div class="code-block"><span class="lang-label">$1</span><pre><code>$2</code></pre></div>').replace(/`([^`]+)`/g,'<code class="inline-code">$1</code>').replace(/^\* (.*$)/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/s,'<ul class="theory-list">$1</ul>').replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^-{3,}$/gm,'<hr class="theory-hr">').replace(/^> (.*$)/gm,'<blockquote class="theory-quote">$1</blockquote>').replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" class="theory-link" target="_blank">$1</a>').replace(/\n\n/g,'</p><p class="theory-paragraph">').replace(/^\s*([^\n]+)(?=\n|$)/gm,'<p class="theory-paragraph">$1</p>').replace(/<\/p><p class="theory-paragraph"><\/p>/g,"").replace(/<p class="theory-paragraph"><\/p>/g,""):""}function v(){const e=window.scrollY,s=document.documentElement.scrollHeight,l=window.innerHeight,o=s-l;if(o<=0){h.value=!1;return}const y=o/2;h.value=e<y}function C(){const e=h.value?document.documentElement.scrollHeight:0;window.scrollTo({top:e,behavior:"smooth"})}return S(()=>{m(),window.addEventListener("scroll",v),v()}),j(()=>{window.removeEventListener("scroll",v)}),B(()=>u.path,()=>{m()}),(e,s)=>x.value?(c(),a("div",R,[g.value?(c(),a("div",Y,[...s[3]||(s[3]=[t("p",null,"Загрузка урока...",-1)])])):d.value?(c(),a("div",z,[s[4]||(s[4]=t("h2",null,"Ошибка",-1)),t("p",null,r(d.value),1),t("button",{onClick:m},"Попробовать снова")])):n.value?(c(),a("div",A,[t("h1",null,"Изучаем:"+r(f.value),1),t("div",D,[t("h2",null,r(n.value.title),1),s[5]||(s[5]=t("li",{class:"far fa-clock"},null,-1)),q(" "+r(n.value.time)+" минут ",1),t("p",null,r(n.value.description),1)]),t("div",G,[s[6]||(s[6]=t("h3",null,"Что вы узнаете:",-1)),t("ul",null,[(c(!0),a(I,null,N(n.value.points,l=>(c(),a("li",{key:l},r(l),1))),128))])]),t("div",U,[s[7]||(s[7]=t("h3",{class:"theory-title"},"Теория",-1)),t("div",{class:"theory-content",innerHTML:H(n.value.theory)},null,8,K)]),t("div",O,[t("button",{class:"btn-back",onClick:s[0]||(s[0]=l=>J(b).go(-1))}," Назад "),t("button",{class:"btn-back",id:"next-theme",onClick:s[1]||(s[1]=l=>T()),disabled:!i.value}," Следующая Тема ",8,Q)])])):w("",!0),t("button",{class:"btn-heigth",onClick:s[2]||(s[2]=l=>C())},[t("i",{class:M(h.value?"fas fa-arrow-down":"fas fa-arrow-up")},null,2)])])):w("",!0)}},se=E(W,[["__scopeId","data-v-693fbc09"]]);export{se as default};
